import{a as H}from"./chunk-DXEAHCV2.js";import{a as ct}from"./chunk-LRG2ALBG.js";import"./chunk-P6OXOXUO.js";import{A as it,B as rt,C as at,k as X,l as $,m as U,n as J,o as K,p as Y,t as Z,u as tt,v as et,x as ot,z as nt}from"./chunk-QTROLIRN.js";import{b as N,f as q,h as L,i as Q,k as W,l as G}from"./chunk-JCYDLHOV.js";import"./chunk-BNSYELAG.js";import{d as B,e as T,f as z,h as F,i as j,o as A,q as R}from"./chunk-E4KDVWXH.js";import{$a as y,Db as E,Eb as C,Fb as k,Jb as c,Kb as M,Lb as x,Nb as w,Ob as P,Pa as d,Pb as V,Sb as D,Tb as I,Ua as g,Ub as O,Vb as S,fb as _,lb as l,ma as p,na as u,oa as h,qb as n,rb as i,sb as b,tb as f,yb as v,zb as s}from"./chunk-FLW74USA.js";var st=["confirmacionBorrado"],lt=["confirmacionVenta"],pt=e=>({"sin-stock":e});function ut(e,o){e&1&&(n(0,"h1",17),c(1," Edici\xF3n evento"),i())}function mt(e,o){e&1&&(n(0,"h1",17),c(1," Ventas evento"),i())}function vt(e,o){if(e&1){let t=f();n(0,"button",18),v("click",function(){p(t);let r=s(2);return u(r.verEstadisticas())}),h(),n(1,"svg",19),b(2,"path",20),i()()}}function ft(e,o){if(e&1){let t=f();n(0,"button",21),v("click",function(){p(t);let r=s(2);return u(r.borrarEvento())}),h(),n(1,"svg",22),b(2,"polyline",23)(3,"path",24)(4,"path",25)(5,"path",26)(6,"path",27),i()()}}function _t(e,o){if(e&1&&(n(0,"p",28),c(1),I(2,"date"),i()),e&2){let t=s(2);d(),x(" \u{1F4C5} ",O(2,1,t.evento.fecha,"dd 'de' MMMM 'de' y")," ")}}function gt(e,o){if(e&1){let t=f();n(0,"button",29),v("click",function(){p(t);let r=s(2);return u(r.abrirAgregarProducto())}),c(1,"+ Productos"),i()}}function xt(e,o){if(e&1&&(n(0,"p"),c(1),i()),e&2){let t=s().$implicit;d(),x("Stock: ",t.stock,"")}}function ht(e,o){e&1&&(n(0,"p",37),c(1,"Sin Stock"),i())}function bt(e,o){e&1&&(n(0,"p",37),c(1,"Ultimo stock el de muestra"),i())}function Et(e,o){if(e&1){let t=f();n(0,"button",38),v("click",function(){p(t);let r=s().$implicit,m=s(2);return u(m.abrirModalVender(r))}),c(1,"Vender"),i()}}function Ct(e,o){e&1&&(n(0,"p",39),c(1,"X"),i())}function kt(e,o){if(e&1){let t=f();n(0,"button",40),v("click",function(){p(t);let r=s().$implicit,m=s(2);return u(m.editarProducto(r))}),h(),n(1,"svg",41),b(2,"path",42)(3,"path",43),i()()}}function Mt(e,o){if(e&1&&(n(0,"div",30)(1,"div",31)(2,"h3"),c(3),i(),n(4,"p"),c(5),i(),n(6,"p"),c(7),i(),n(8,"p"),c(9),i(),_(10,xt,2,1,"p",32)(11,ht,2,0,"p",33)(12,bt,2,0,"p",33),i(),_(13,Et,2,0,"button",34)(14,Ct,2,0,"p",35)(15,kt,4,0,"button",36),i()),e&2){let t=o.$implicit,a=s(2);l("ngClass",D(11,pt,t.stock==0)),d(3),M(t.nombre),d(2),x(" Precio: ",t.precio,"\u20AC"),d(2),x("Muestra: ",t.venderMuestra?"Si":"No",""),d(2),x("Vendidos: ",t.vendidos,""),d(),l("ngIf",t.stock>0&&!(t.stock==1&&t.venderMuestra)),d(),l("ngIf",t.stock==0),d(),l("ngIf",t.stock==1&&t.venderMuestra),d(),l("ngIf",t.stock>0&&!a.modoEdicion),d(),l("ngIf",t.stock==0&&!a.modoEdicion),d(),l("ngIf",a.modoEdicion)}}function wt(e,o){if(e&1){let t=f();n(0,"div",3)(1,"div",4),v("click",function(){p(t);let r=s();return u(r.irAInicio())}),n(2,"span"),c(3,"Gestionart"),i()(),_(4,ut,2,0,"h1",5)(5,mt,2,0,"h1",5),n(6,"div",6)(7,"div",7)(8,"h1",8),c(9),i(),n(10,"div",9),_(11,vt,3,0,"button",10)(12,ft,7,0,"button",11),i()(),_(13,_t,3,4,"p",12)(14,gt,2,0,"button",13),i(),n(15,"div")(16,"input",14),V("ngModelChange",function(r){p(t);let m=s();return P(m.terminoBusqueda,r)||(m.terminoBusqueda=r),u(r)}),v("input",function(){p(t);let r=s();return u(r.filtrarProductos())}),i()(),n(17,"div",15),_(18,Mt,16,13,"div",16),i()()}if(e&2){let t=s();d(4),l("ngIf",t.modoEdicion),d(),l("ngIf",!t.modoEdicion),d(4),M(t.evento.nombre),d(2),l("ngIf",!t.modoEdicion),d(),l("ngIf",t.modoEdicion),d(),l("ngIf",t.evento.fecha),d(),l("ngIf",t.modoEdicion),d(2),w("ngModel",t.terminoBusqueda),d(2),l("ngForOf",t.productosEventoFiltrados)}}function Pt(e,o){if(e&1){let t=f();n(0,"div",44)(1,"h2",45),c(2,"\xBFConfirmar borrado?"),i(),n(3,"mat-dialog-content"),c(4," \xBFEst\xE1s seguro de que quieres borrar este evento? "),i(),n(5,"mat-dialog-actions",46)(6,"button",47),c(7,"Cancelar"),i(),n(8,"button",48),v("click",function(){p(t);let r=s();return u(r.confirmarBorrado())}),c(9,"Borrar"),i()()()}}function Vt(e,o){if(e&1){let t=f();n(0,"div",49)(1,"h2",50),c(2,"\xBFConfirmar venta?"),i(),n(3,"mat-dialog-content",51)(4,"p"),c(5,"Se va a realizar una venta."),i(),n(6,"mat-form-field",52)(7,"mat-label"),c(8,"Cantidad vendida"),i(),n(9,"input",53),V("ngModelChange",function(r){p(t);let m=s();return P(m.cantidad,r)||(m.cantidad=r),u(r)}),i()()(),n(10,"mat-dialog-actions",54)(11,"button",47),c(12,"Cancelar"),i(),n(13,"button",55),v("click",function(){p(t);let r=s();return u(r.confirmarVenta())}),c(14,"Vender"),i()()()}if(e&2){let t=s();d(9),w("ngModel",t.cantidad)}}var dt=class e{constructor(o,t,a,r,m,St){this.eventoService=o;this.productosService=t;this.route=a;this.router=r;this.dialog=m;this.snackBar=St}idEvento="";evento;productosEvento;productosEventoFiltrados;terminoBusqueda="";modoEdicion=!1;cantidad=1;productoVender;confirmacionBorradoTemplate;confirmacionVentaTemplate;ngOnInit(){this.route.paramMap.subscribe(a=>{this.idEvento=a.get("idEvento")||"",this.idEvento&&this.obtenerEvento()});let o=this.router.url,t=this.route.snapshot.url;if(t.length>=2){let a=t[1].path,r=t[2]?.path;a==="detalle"?(this.modoEdicion=!1,this.idEvento=r):this.modoEdicion=!0,console.log(this.modoEdicion)}}irAInicio(){this.router.navigate([""])}obtenerEvento(){this.eventoService.getEvento(this.idEvento).subscribe(o=>{this.evento=o,this.obtenerProductos()})}obtenerProductos(){this.productosService.getProductosEvento(this.idEvento).subscribe(o=>{this.productosEvento=o,console.log(o),this.productosEventoFiltrados=[...this.productosEvento]})}filtrarProductos(){let o=this.terminoBusqueda.toLowerCase().trim();o===""?this.productosEventoFiltrados=[...this.productosEvento]:this.productosEventoFiltrados=this.productosEvento.filter(t=>t.nombre.toLowerCase().includes(o))}abrirAgregarProducto(){this.router.navigate([`/eventos/${this.idEvento}/addProductos`])}abrirModalVender(o){this.productoVender=o,this.dialog.open(this.confirmacionVentaTemplate)}editarProducto(o){this.dialog.open(ct,{data:{producto:o,modo:"EditarProductoEvento"}}).afterClosed().subscribe(a=>{})}borrarEvento(){this.dialog.open(this.confirmacionBorradoTemplate)}confirmarVenta(){this.productoVender.stock<this.cantidad?this.snackBar.open("X Stock insuficiente","",{duration:2500,panelClass:["error-snackbar"],horizontalPosition:"center",verticalPosition:"top"}):this.productoVender.stock==this.cantidad&&this.productoVender.venderMuestra?(this.snackBar.open("\u2713 Tambi\xE9n venderas el de muestra","",{duration:2500,panelClass:["success-snackbar"],horizontalPosition:"center",verticalPosition:"top"}),this.productoVender.stock=this.productoVender.stock-this.cantidad,this.productoVender.vendidos=this.productoVender.vendidos+this.cantidad,this.productoVender.ganancias=this.productoVender.ganancias+this.cantidad*this.productoVender.precio,this.productosService.updateProductoEvento(this.productoVender),this.snackBar.open("\u2713 Producto vendido","",{duration:2500,panelClass:["success-snackbar"],horizontalPosition:"center",verticalPosition:"top"})):(this.productoVender.stock=this.productoVender.stock-this.cantidad,this.productoVender.vendidos=this.productoVender.vendidos+this.cantidad,this.productoVender.ganancias=this.productoVender.ganancias+this.cantidad*this.productoVender.precio,this.productosService.updateProductoEvento(this.productoVender),this.snackBar.open("\u2713 Producto vendido","",{duration:2500,panelClass:["success-snackbar"],horizontalPosition:"center",verticalPosition:"top"})),this.cantidad=1,this.dialog.closeAll()}verEstadisticas(){this.router.navigate([`/eventos/${this.idEvento}/estadisticas`])}confirmarBorrado(){this.evento.id&&(this.eventoService.borrarEvento(this.evento.id),this.snackBar.open("\u2713 Evento eliminado","",{duration:2500,panelClass:["success-snackbar"],horizontalPosition:"center",verticalPosition:"top"}),this.productosEvento&&this.productosEvento.forEach(o=>{o.id&&this.productosService.deleteProductoEvento(o.id)})),this.dialog.closeAll(),this.router.navigate(["/eventos/lista"])}static \u0275fac=function(t){return new(t||e)(g(H),g(rt),g(A),g(R),g(X),g(at))};static \u0275cmp=y({type:e,selectors:[["detalle-evento-component"]],viewQuery:function(t,a){if(t&1&&(E(st,5),E(lt,5)),t&2){let r;C(r=k())&&(a.confirmacionBorradoTemplate=r.first),C(r=k())&&(a.confirmacionVentaTemplate=r.first)}},decls:5,vars:1,consts:[["confirmacionBorrado",""],["confirmacionVenta",""],["class","detalles-evento",4,"ngIf"],[1,"detalles-evento"],[1,"app-nombre",3,"click"],["class","titulo",4,"ngIf"],[1,"evento-header"],[1,"header-top",2,"display","flex","align-items","center","justify-content","space-between"],[2,"margin","0"],[2,"display","flex","gap","10px"],["class","icon-button-stats","title","Ver estad\xEDsticas",3,"click",4,"ngIf"],["class","icon-button","title","Borrar evento",3,"click",4,"ngIf"],["class","fecha-evento",4,"ngIf"],["class","add-button",3,"click",4,"ngIf"],["type","text","placeholder","Buscar producto por nombre",1,"buscador-productos",3,"ngModelChange","input","ngModel"],[1,"productos-lista"],["class","producto-card",3,"ngClass",4,"ngFor","ngForOf"],[1,"titulo"],["title","Ver estad\xEDsticas",1,"icon-button-stats",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","50","height","30","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","viewBox","0 0 24 24"],["d","M3 12h3v8H3zM9 8h3v12H9zM15 4h3v16h-3z"],["title","Borrar evento",1,"icon-button",3,"click"],["xmlns","http://www.w3.org/2000/svg","width","20","height","20","fill","none","stroke","currentColor","stroke-width","2","stroke-linecap","round","stroke-linejoin","round","viewBox","0 0 24 24"],["points","3 6 5 6 21 6"],["d","M19 6l-1 14a2 2 0 0 1-2 2H8a2 2 0 0 1-2-2L5 6"],["d","M10 11v6"],["d","M14 11v6"],["d","M9 6V4a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v2"],[1,"fecha-evento"],[1,"add-button",3,"click"],[1,"producto-card",3,"ngClass"],[1,"info"],[4,"ngIf"],["class","out-stock",4,"ngIf"],["class","vender-button",3,"click",4,"ngIf"],["class","vendido-cruz",4,"ngIf"],["class","edit-icon","title","Editar producto",3,"click",4,"ngIf"],[1,"out-stock"],[1,"vender-button",3,"click"],[1,"vendido-cruz"],["title","Editar producto",1,"edit-icon",3,"click"],["viewBox","0 0 24 24","width","20","height","20","stroke","currentColor","fill","none","stroke-width","2"],["d","M12 20h9"],["d","M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"],[1,"dialog-outfit-font"],["mat-dialog-title",""],["align","end"],["mat-button","","mat-dialog-close",""],["mat-button","","color","warn",3,"click"],[1,"venta-dialog-container"],["mat-dialog-title","",1,"venta-titulo"],[1,"venta-contenido"],["appearance","fill",2,"width","100%"],["matInput","","type","number","min","1",3,"ngModelChange","ngModel"],["align","end",1,"venta-acciones"],["mat-button","","color","primary",3,"click"]],template:function(t,a){t&1&&_(0,wt,19,9,"div",2)(1,Pt,10,0,"ng-template",null,0,S)(3,Vt,15,1,"ng-template",null,1,S),t&2&&l("ngIf",a.evento)},dependencies:[G,N,Q,q,W,L,j,B,T,z,F,Y,$,U,K,J,tt,Z,it,nt,ot,et],styles:['.detalles-evento[_ngcontent-%COMP%]{min-height:100vh;padding:24px 16px;display:flex;flex-direction:column;background-image:url("./media/f-MHIBCXNN.jpg");background-size:cover;background-position:center;color:#fff;text-align:center;justify-content:flex-start;background-attachment:fixed;align-items:center;box-shadow:0 4px 8px #0003}.titulo[_ngcontent-%COMP%]{margin-top:40px;margin-bottom:10px}.edit-icon[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;float:right;align-items:center;justify-content:center;margin-top:10%;margin-right:10px}.evento-header[_ngcontent-%COMP%]{width:100%;padding:16px;margin-top:5px;margin-bottom:15px;display:flex;flex-direction:column;background-color:#00000041;-webkit-backdrop-filter:blur(9000px);backdrop-filter:blur(9000px);border-radius:15px;color:#fff;text-align:left}.header-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.evento-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px;margin:0}.fecha-evento[_ngcontent-%COMP%]{font-size:14px;margin-top:4px;color:#f0f0f0}.add-button[_ngcontent-%COMP%]{padding:6px 12px;margin-top:13px;font-size:14px;background-color:#fff;border:none;border-radius:6px;color:#000;font-weight:700;cursor:pointer;transition:background-color .3s ease}.add-button[_ngcontent-%COMP%]:hover{background-color:#f0e0c9}.icon-button[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;margin-left:90px;padding:0;color:#bf1c1c;transition:transform .2s ease}.icon-button-stats[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer;color:#fff;padding-top:36px;display:flex;align-items:center;justify-content:center;transition:transform .2s ease}.icon-button-stats[_ngcontent-%COMP%]:hover, .icon-button[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.productos-lista[_ngcontent-%COMP%]{width:100%;padding:16px}.producto-card[_ngcontent-%COMP%]{display:flex;align-items:center;background:linear-gradient(135deg,#b7ccf2fc,#d8ab90);border-radius:12px;padding:16px;margin-bottom:12px;box-shadow:0 2px 4px #0000001a}.producto-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{flex-grow:1}.sin-stock[_ngcontent-%COMP%]{border:2px solid red}.out-stock[_ngcontent-%COMP%]{color:red!important;font-weight:bolder!important;font-size:17px!important}.vendido-cruz[_ngcontent-%COMP%]{color:red;font-size:20px}.producto-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 8px;font-size:20px;font-weight:600;color:#222}.producto-card[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:16px;color:#131313}.vender-button[_ngcontent-%COMP%]{flex-shrink:0;padding:6px 10px;font-size:13px;background:#f7f7f747;-webkit-backdrop-filter:blur(20px);backdrop-filter:blur(20px);color:#000;border:2px solid rgba(0,0,0,.385);border-radius:5px;font-weight:700;cursor:pointer;margin-left:12px;transition:background-color .3s ease}.vender-button[_ngcontent-%COMP%]:hover{background-color:#388e3c}.buscador-productos[_ngcontent-%COMP%]{width:100%;padding:.5rem .9rem;font-size:1.1rem;border:none;border-bottom:2px solid #000000;outline:none;transition:border-color .3s;font-family:Outfit,sans-serif;background:#ffffffb0;border-radius:5px}.buscador-productos[_ngcontent-%COMP%]::placeholder{color:#000;opacity:1}.app-nombre[_ngcontent-%COMP%]{position:absolute;top:16px;left:24px;font-size:17px;font-weight:600;color:#fff;cursor:pointer;z-index:10;text-transform:uppercase;letter-spacing:.5px;text-shadow:1px 1px 2px rgba(0,0,0,.3);transition:transform .2s ease,color .2s ease}.app-nombre[_ngcontent-%COMP%]:hover{transform:scale(1.05);color:#fff}']})};export{dt as DetalleEventoComponent};
